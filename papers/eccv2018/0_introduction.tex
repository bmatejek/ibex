% !TEX root =  paper.tex
\section{Introduction}

% \begin{figure}[t!]
% 	\centering
% 	\includegraphics[width=\linewidth]{./figures/teaser_v2.png}
% 	\caption{Our proposed framework uses both local and global biological constraints to improve an input segmentation.}
% 	\label{fig:teaser}
% \end{figure}
\begin{figure}[t!]
	\centering
	\includegraphics[width=\linewidth]{./figures/teaser_v4.png}
	\caption{Our framework uses both geometric and topological biological constraints for region merging. We (a) generate a simplified graph from the skeleton representation of the input segmentation, (b) train a classifier to learn the edge weight based on the shape of the segment connection, and (c) perform graph partitioning with acyclic constraints.}
	\label{fig:teaser_pipeline}
\end{figure}

The field of connectomics considers the problem of reconstructing the wiring diagram of the brain at nanometer resolutions to enable new insights into the workings of the brain~\cite{haehn2017scalable,kasthuri2015saturated}. 
%Recent advancements in image acquisition using multi-beam serial-section electron microscopy (sSEM) allow researchers to produce terabytes of image data per hour~\cite{hildebrand2017whole}. 
%It is infeasible for domain experts to manually reconstruct this vast amount of image data~\cite{haehn2014design}. 
State-of-the-art automatic 3D reconstruction approaches use pixel-based convolutional neural networks (CNNs) and watershed transforms to generate initial over-segmentation, followed by region merging steps~\cite{seymour2016rhoananet,lee2015recursive,nunez2014graph,parag2017anisotropic,ronneberger2015u,zlateski2015image}.
%For region merging, most methods do not use prior biological knowledge of the 3D shape of neural structures.

%\TODO{the selling point is to add biological constraint}
%We present a \textit{top-down graph-based} method that builds on the outputs of bottom-up pixel-based segmentation approaches. 
There are two types of errors in connectomics segmentations.
In a \textit{split error}, multiple segments compose a single neuronal process. 
In a \textit{merge error}, two neurons incorrectly merge to form a single segment. 
Generally, it is much more difficult to correct merge errors than to correct split errors, as the space of possible split proposals grows quickly~\cite{parag2015properties}.
Thus, most reconstruction approaches are tuned towards over-segmentation with many more split than merge errors.
We focus on correcting these split errors in the input segmentation.

Due to their biological nature, these over-segmented regions are connected with specific geomtric and topological properties. For example, L-shape juctions and Arrow-shape junctions are rare in neural structures and these regions do not form cycles. Thus, we can make use and learn these shape prior information to produce more accurate region merging to match the underlying biology (Fig.~\ref{fig:teaser_pipeline}).

We present a new region merging framework that imposes both local and global biological constraints onto the output segmentation to match the underlying structure of neuronal processes.
We first extract skeletons from labels in the input segmentation and generate a simplified graph (Fig.~\ref{fig:teaser_pipeline}a). 
Next, we train a CNN classifier to learn biological constraints on the local structural shape of a neuron (Fig.~\ref{fig:teaser_pipeline}b).
This classifier produces probabilities that two segments belong to the same neuron based on the input shapes of the segments.
These probabilities correspond to edge weights in our graph extracted from the input segmentation.
We then use a graph optimization algorithm to partition the graph into a final improved reconstruction by enforcing domain-specific topological constraints from biology (Fig.~\ref{fig:teaser_pipeline}c).

%Our approach operates at a level of abstraction above existing pixel-based methods. 
%This allows us to leverage both local and global information to produce more accurate reconstructions. 

Our method is independent of image resolution and acquisition parameters, enabling its application to isotropic and anisotropic image data without retraining.
Images generated by electron microscopes often differ in appearance because of variations in staining techniques \cite{briggman2012volume}.
By removing the dependence of our algorithm on the input images, we greatly reduce the need for additional costly ground truth data for each new stack of images.
Using the graph induced by the segmentation allows us to enforce global biological constraints on the reconstruction. 
Our dual approach of assessing local decisions in a global context yields accuracy improvements over existing reconstruction methods.


This work makes three contributions:
first, a novel top-down framework that extracts graphs from skeletonized 3D segmentations for improved region merging for neural reconstruction of connectomics data; 
next, a region-based CNN classifier to detect split errors; 
%(3) an empirical evaluation of our method on several connectomics datasets;  % this is not contribution
last, improved variation of information performance over a state-of-the-art pixel-based reconstruction approach on average by $8.2\%$ while maintaining scalable runtimes for large volumes.
